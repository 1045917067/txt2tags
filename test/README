
========================================================================


                        +---------------------+
                        | txt2tags test-suite |
                        +---------------------+


                        +---------------------+
                        | http://txt2tags.org |
                        +---------------------+


========================================================================

------------------------------------------------------------------------

Requirements:

    sudo pip install -U pytest

Usage:

    cd test
    ./run-all-tests           # run all tests (including bash tests)
    py.test-2.7               # run all Python tests
    py.test-2.7 -k headers    # just test the 'headers' module
    py.test-2.7 --ignore art  # skip the 'art' module

Extra tests, not yet integrated into py.test suite:

    ./sample/run.sh
    ./art/run.sh
    ./path/run.sh
    ./outfile/run.sh

------------------------------------------------------------------------

MODULES

There are several test modules (the folders). Inside them you will
find these files/folders:

ok/
    The OK-templates folder. Each file here holds the correct output
    for a performed test.

*.t2t
    The tests.

    Note: If there are no t2t files, they're generated on the fly by
          the module's test_X.py.

------------------------------------------------------------------------

HOW IT WORKS

py.test automatically finds and runs all test functions. Due to
historical reasons we have configured it to consider all functions that
reside in test_X.py files and are called run().

The module's test_X.py script performs all the module's tests.
Basically it converts each of the .t2t files and compares the results
with the template inside the 'ok' folder. If they match, the test
passes. Otherwise the difference between the two versions is printed.
and the test fails.

------------------------------------------------------------------------

HOW TO FIX ERRORS

If it's a bug in the txt2tags code, fix it and run the test again until
it's OK.

If the txt2tags behavior changed and now that's the desired output, you
should update the OK template.

------------------------------------------------------------------------

HOW TO ADD A NEW TEST

Just create a new .t2t file inside the related module, and put the
desired output inside the 'ok' folder.

For example, if a new mark 'foobar' is created, you should add a
marks/foobar.t2t file to test the feature, and a marks/ok/foobar.html
file with the correct output. And that's it.

    Note: The new file is tested because marks/test_marks.py tests *.t2t

    Note: HTML is the default target in 'marks' module. But it varies
          in other modules.

Each module's test script has its own way of doing tests. Read it to
understand how the tests are performed. In the 'headers' module for
example, there are no t2t files, they're generated on the fly.

Except for special cases, each .t2t file inside a module is a full
txt2tags file.
So you can tweak it as needed, adding %!settings, %!postproc, etc.

------------------------------------------------------------------------

